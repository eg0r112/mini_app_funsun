<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FUN&SUN | –ü–æ–∏—Å–∫ –±–∏–ª–µ—Ç–æ–≤</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Segoe UI", Roboto, sans-serif;
        }

        body {
            background-color: #0d0d0d;
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
            z-index: 0;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 2rem;
            color: #ffcc00;
            letter-spacing: 1px;
        }

        h2 {
            display: none;
        }

        .search-container {
            display: flex;
            background-color: #1b1b1b;
            border-radius: 50px;
            overflow: hidden;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.2);
            position: relative;
            z-index: 1;
        }

        .search-container input {
            flex: 1;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            border: none;
            outline: none;
            color: #fff;
            background: transparent;
        }

        .search-container button {
            background-color: #ffcc00;
            color: #000;
            border: none;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .search-container button:hover { background-color: #ffdb4d; }



        @media (max-width: 600px) {
            body { 
                justify-content: flex-start; 
                padding: 1rem; 
                background: linear-gradient(to bottom, #0d0d0d, #1a1a1a); 
                min-height: 100vh;
            }
            h2 { 
                display: block; 
                font-size: 1rem; 
                color: #ccc; 
                margin-bottom: 1.5rem; 
                text-align: center; 
            }
            body::before {
                content: "";
                position: absolute;
                top: -50px;
                left: 50%;
                transform: translateX(-50%);
                width: 150px;
                height: 150px;
                background: radial-gradient(circle, #ffcc00 0%, #ff9900 70%);
                border-radius: 50%;
                opacity: 0.3;
                z-index: 0;
            }
            h1 { font-size: 1.8rem; margin-top: 2rem; }
            .search-container {
                flex-direction: column;
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                width: 90%;
                max-width: 400px;
                background-color: #222;
                padding: 1rem;
                border-radius: 25px;
                box-shadow: 0 4px 20px rgba(255, 204, 0, 0.3);
            }
            .search-container input, .search-container button { width: 100%; font-size: 1.1rem; margin: 0.3rem 0; border-radius: 12px; }
            .search-container button { border-top: 1px solid #333; padding: 1rem; }
        }

        @media (min-width: 601px) {
            h2 { display: none; }
            body::before { display: none; }
        }
    </style>
</head>
<body>
    <h1>FUN&SUN ‚Äî –ü–æ–∏—Å–∫ –±–∏–ª–µ—Ç–æ–≤</h1>
    <h2>–ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–ø—É—Å–∫!</h2>

    <!-- –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –±–ª–æ–∫ –ø–æ–∏—Å–∫–∞ -->
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="–ö—É–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è?" />
        <button id="searchBtn">–ù–∞–π—Ç–∏</button>
    </div>

    <script>
        // // –ü–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç Telegram WebApp
        // const tg = window.Telegram?.WebApp;
        // const searchBtn = document.getElementById('searchBtn');
        // const searchInput = document.getElementById('searchInput');
        
        // // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–Ω–æ–ø–∫–∏
        // function setButtonState(disabled, text) {
        //     searchBtn.disabled = disabled;
        //     searchBtn.textContent = text;
        // }
        
        // // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Web App
        // function initWebApp() {
        //     if (tg) {
        //         tg.ready(); // —É–≤–µ–¥–æ–º–ª—è–µ–º Telegram, —á—Ç–æ WebApp –≥–æ—Ç–æ–≤
        //         tg.expand(); // —Ä–∞—Å—à–∏—Ä—è–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
                
        //         // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è
        //         tg.MainButton.hide();
        //         tg.BackButton.hide();
                
        //         // –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
        //         tg.enableClosingConfirmation();
                
        //         // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è
        //         tg.onEvent('viewportChanged', function() {
        //             console.log('Viewport changed');
        //         });
                
        //         console.log('Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        //     } else {
        //         console.log('Telegram Web App –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - —Ä–∞–±–æ—Ç–∞–µ–º –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ');
        //     }
        // }
        
        // // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
        // function sendDataToBot() {
        //     const query = searchInput.value.trim();
            
        //     if (!query) {
        //         return;
        //     }

        //     if (!tg) {
        //         return;
        //     }

        //     // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
        //     setButtonState(true, '‚è≥ –ü–æ–∏—Å–∫...');

        //     try {
        //         // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        //         const data = {
        //             searchQuery: query,
        //             timestamp: new Date().toISOString(),
        //             source: 'mini_app'
        //         };
                
        //         console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ:', data);
                
        //         // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
        //         localStorage.setItem('searchQuery', query);
        //         localStorage.setItem('searchData', JSON.stringify(data));
                
        //         // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É —á–µ—Ä–µ–∑ POST –∑–∞–ø—Ä–æ—Å
        //         setTimeout(() => {
        //             // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ POST –∑–∞–ø—Ä–æ—Å –∫ –±–æ—Ç—É
        //             fetch('https://api.telegram.org/bot8223263312:AAFnIhUBUUmUJEpu-ZW0mWjHlRRma2McoNk/sendMessage', {
        //                 method: 'POST',
        //                 headers: {
        //                     'Content-Type': 'application/json',
        //                 },
        //                 body: JSON.stringify({
        //                     chat_id: tg.initDataUnsafe.user?.id || '5143241640', // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –≤–∞—à ID
        //                     text: `üîç –ù–æ–≤—ã–π –ø–æ–∏—Å–∫: ${query}\n‚è∞ –í—Ä–µ–º—è: ${data.timestamp}\nüì± –ò—Å—Ç–æ—á–Ω–∏–∫: –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ`,
        //                     parse_mode: 'HTML'
        //                 })
        //             })
        //             .then(response => response.json())
        //             .then(result => {
        //                 console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –±–æ—Ç—É —á–µ—Ä–µ–∑ POST:', result);
        //             })
        //             .catch(error => {
        //                 console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —á–µ—Ä–µ–∑ POST:', error);
                        
        //                 // Fallback: –ø–æ–ø—Ä–æ–±—É–µ–º tg.sendData
        //                 if (tg && typeof tg.sendData === 'function') {
        //                     try {
        //                         tg.sendData(JSON.stringify(data));
        //                         console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –±–æ—Ç—É —á–µ—Ä–µ–∑ tg.sendData');
        //                     } catch (sendError) {
        //                         console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —á–µ—Ä–µ–∑ tg.sendData:', sendError);
        //                     }
        //                 }
        //             });
        //         }, 100);
                
        //         // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–∞–Ω–∏—á–∫—É —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        //         setTimeout(() => {
        //             window.location.href = `results.html?query=${encodeURIComponent(query)}`;
        //         }, 500);
                
        //     } catch (error) {
        //         console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ:', error);
                
        //         // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –ø—Ä–∏ –æ—à–∏–±–∫–µ
        //         setButtonState(false, '–ù–∞–π—Ç–∏');
        //     }
        // }
        
        // // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        // searchBtn.addEventListener('click', sendDataToBot);
        
        // searchInput.addEventListener('keypress', (e) => {
        //     if (e.key === 'Enter') {
        //         sendDataToBot();
        //     }
        // });
        
        // // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
        // searchInput.focus();
        
        // // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        // window.addEventListener('load', initWebApp);
        const input = document.getElementById('searchInput');
        const button = document.getElementById('searchBtn');

        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ
        button.addEventListener('click', () => {
        const query = input.value.trim();

        if (!query) {
                return;
            }

        // –ü—Ä–∏–º–µ—Ä: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        fetch("http://localhost:5171/api/webapp/receive", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ searchQuery: query })
        })
        .then(res => res.json())
        .then(data => {
            console.log("–û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:", data);

            // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ results.html —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–Ω—è–ª –¥–∞–Ω–Ω—ã–µ
            if (data.success) {
                window.location.href = `results.html?query=${encodeURIComponent(query)}`;
            } else {
                alert("–°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª –æ—à–∏–±–∫–æ–π: " + (data.message || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"));
            }
        })
        .catch(err => console.error("–û—à–∏–±–∫–∞:", err));
        });
    </script>
</body>
</html>